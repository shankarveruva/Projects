<html>
    <head>
        <title>FIT5147 Assignment 1: D3 visualisation</title>
        <style>
            .svgCanvas {
                border: solid 1px
            }
        </style>
    </head>
    <body>
        <svg></svg>
        
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script>
            window.onload = function(){
                // Canvas width and height
                var width = 1000;
                var height = 700;
                
                // Create a SVG canvas
                var svgCanvas = d3.select("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("class", "svgCanvas");
                
                d3.json("data.json", function(d){
                    console.log(d); 
                    
                    
        var nodes = d.nodes.map(function(thisElement) { return thisElement; });                
        var links = d.links.map(function(thisElement) { return thisElement; });
               
             
        links.forEach(function(link){
            svgCanvas.append('line')
            .attr('x1', function(a){
                nodes.forEach(function(node){
                if (link.node01 == node.id){
                    a=node.x;
                    return node.x; 
                }      
            });return a;})
            .attr('y1', function(a){
                nodes.forEach(function(node){
                if (link.node01 == node.id){
                    a=node.y
                    return node.y;  
                }
                    
            }); return a;})
            .attr('x2', function(a){
                nodes.forEach(function(node){
                if (link.node02 == node.id){
                    a=node.x
                    return node.x;  
                }
            }); return a;})
            .attr('y2', function(a){
                nodes.forEach(function(node){
                if (link.node02 == node.id){
                    a=node.y;
                    return node.y;  
                }
            }); return a;})
            .attr('stroke-width', function(a){
                a = link.amount/300;
                return a;})
            .attr('stroke','black');
        });
              
                    
        nodes.forEach(function(node){
            svgCanvas.append('circle')
            .attr('cx', node.x)
            .attr('cy', node.y)
            .attr('r', 10)
            .attr('fill','lightblue');
            
        });
                    
//                links.forEach(function(link){
//            nodes.forEach(function(node){
//                    svgCanvas.append('line')
//                    .attr('x1', function(){
//                        if (link.node01 == node.id)
//                            return node.x
//                    })
//                    .attr('y1', function(){
//                        if (link.node01 == node.id)
//                            return node.y
//                    })
//                    .attr('x2', function(){
//                        if (link.node02 == node.id)
//                            return node.x
//                    })
//                    .attr('y2', function(){
//                        if (link.node02 == node.id)
//                            return node.y
//                    })
//                    .attr('stroke','black');  
//            });
//        });
                    
                    
//            
//        links.forEach(function(link){
//            svgCanvas.append('line')
//            .attr('x1', function(){
//                nodes.forEach(function(node){
//                if (link.node01 == node.id)
//                    return node.x;  
//            })})
//            .attr('y1', function(){
//                nodes.forEach(function(node){
//                if (link.node01 == node.id)
//                    return node.y;  
//            })})
//            .attr('x2', function(){
//                nodes.forEach(function(node){
//                if (link.node02 == node.id)
//                    return node.x;  
//            })})
//            .attr('y2', function(){
//                nodes.forEach(function(node){
//                if (link.node02 == node.id)
//                    return node.y;  
//            })})
//            .attr('stroke','black');
//        });
//              
                    
                    
        });  
                    
                    
}
        </script>
    </body>
</html>